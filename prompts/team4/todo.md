## 📋 重要事項

**⚠️ 必ず `must.md` を確認してください！**

このプロジェクトのゴールと達成基準は [`must.md`](./must.md) に定義されています。
実装前・実装中・実装後に必ず確認し、すべてのゴールを達成できるようにしてください。

- **ゴール 1**: タスクの登録・完了・削除ができる（必須）
- **ゴール 2**: サブタスク機能
- **ゴール 3**: タスク詳細機能
- **ゴール Extra**: より実践的な開発

---

## タスク

C# Web API と Vue.js でシンプルな TODO アプリを作成したいです。

**【ゴール 1】タスクの登録・完了・削除ができる**

実装する機能：

- ✅ タスク名を入力して新規登録できる
- ✅ タスクを完了状態に変更できる
- ✅ タスクを削除できる
- ✅ 登録済みタスクが一覧表示される

## 世界観

**テーマ: 「冒険者のクエストボード」**

タスク管理を冒険者がクエストをこなしていく世界に見立てます。

### コンセプト

- **タスク = クエスト**: 日々の仕事や用事を「クエスト」として表現
- **完了 = クエスト達成**: タスクを完了すると経験値やコインを獲得
- **優先度 = 難易度ランク**: F（簡単）～ S（超難関）のランク付け
- **カテゴリ = ギルド**: 仕事、個人、学習などをギルド（組織）として分類

### UX の特徴

- ファンタジー RPG 風の温かみのあるデザイン
- タスク追加時に「新しいクエストを受注しますか？」
- タスク完了時に「クエスト達成！」と達成感のあるフィードバック
- シンプルだけど少しワクワクする体験

---

## 設計

技術スタックは下記通りです。

- バックエンド: C# / ASP.NET Core Web API
- フロントエンド: TypeScript / Vue.js
- データベース: MySQL

### データモデル

#### Quest（タスク）テーブル

```
- Id: int (主キー, 自動採番)
- Title: string (クエスト名, 必須, 最大200文字)
- Description: string (詳細説明, 任意, 最大1000文字)
- Rank: string (難易度ランク: F/E/D/C/B/A/S, デフォルト: D)
- GuildType: string (ギルド: Work/Personal/Study/Other, デフォルト: Personal)
- IsCompleted: bool (完了フラグ, デフォルト: false)
- Reward: int (報酬ポイント, 自動計算: ランクに応じて 10-1000)
- CreatedAt: DateTime (作成日時)
- CompletedAt: DateTime? (完了日時, nullable)
```

### API 設計

#### エンドポイント一覧

**1. クエスト一覧取得**

```
GET /api/quests
Response: Quest[]
```

**2. クエスト作成**

```
POST /api/quests
Request Body:
{
  "title": "string (必須)",
  "description": "string (任意)",
  "rank": "D" (任意, デフォルト: D),
  "guildType": "Personal" (任意, デフォルト: Personal)
}
Response: Quest
```

**3. クエスト完了/未完了の切り替え**

```
PATCH /api/quests/{id}/toggle
Response: Quest
説明: IsCompletedフラグを反転させる（完了 ⇔ 未完了）
```

**4. クエスト削除**

```
DELETE /api/quests/{id}
Response: 204 No Content
説明: 指定したクエストを削除する
```

**5. クエストのフィルタリング取得（オプション）**

```
GET /api/quests?status=completed
GET /api/quests?status=incomplete
Response: Quest[]
説明: フロントエンドでもフィルタリングできるが、APIでもサポート
```

### フロントエンド構成

#### コンポーネント設計

**1. QuestBoard.vue（メイン画面）**

- クエストボード全体の表示
- **クエスト一覧の表示**（ゴール 1 必須）
- **フィルター機能**（全て/未完了/完了済み）（ゴール 1 必須）
- 新規クエスト追加フォームの表示エリア

**2. QuestForm.vue（クエスト追加フォーム）**

- **タイトル入力欄**（ゴール 1 必須）
- 登録ボタン
- ランク選択（ドロップダウン）※Phase 2 で実装
- ギルドタイプ選択（ドロップダウン）※Phase 2 で実装
- 詳細説明入力欄（折りたたみ可能）※Phase 2 で実装

**3. QuestCard.vue（クエストカード）**

- クエスト情報の表示
- **完了/未完了トグルボタン**（ゴール 1 必須）
- **削除ボタン**（ゴール 1 必須）
- 完了済みクエストは打ち消し線で表示
- ランクに応じた色分け※Phase 2 で実装

**4. QuestStats.vue（統計情報）**

- 総クエスト数
- 完了数
- 未完了数
- 累計報酬ポイント※Phase 2 で実装

### データフロー

```
[ユーザー入力]
  ↓
[QuestForm] → POST /api/quests
  ↓
[API: QuestController] → データベース保存
  ↓
[Response] → [QuestBoard更新]
  ↓
[画面に新しいクエスト表示]
```

---

## 実装を簡単にするアイディア

### 1. 段階的実装（MVP → 拡張）

**Phase 1: 最小限の機能（MVP）= ゴール 1 達成**

- ✅ タスク追加（タイトルのみ）
- ✅ タスク一覧表示
- ✅ タスク完了/未完了の切り替え
- ✅ タスク削除
- フィルター機能（全て/未完了/完了済み）
- **実装時間目安: 2-3 時間**
- **このフェーズでゴール 1 をすべて達成します**

**Phase 2: 世界観の追加**

- ランク（難易度）の追加
- ギルドタイプの追加
- 報酬ポイントの表示
- **実装時間目安: 1-2 時間**

**Phase 3: UX 改善**

- アニメーション効果
- 統計情報の表示
- フィルター機能
- **実装時間目安: 2-3 時間**

### 2. 開発の障害を減らす工夫

#### データベース設定を簡略化

- **初期はメモリ内リスト**: データベース接続せず、まずは API のロジックを完成
- **後から DB 接続**: 動作確認後に MySQL に移行
- **マイグレーション不要**: シンプルなテーブル構造なので手動作成で OK

#### フロントエンドの実装順序

1. **静的な UI を先に作成**: ダミーデータで画面を完成させる
2. **API 接続**: 動く UI ができてから API 呼び出しを追加
3. **エラーハンドリング**: 基本機能が動いてから追加

#### 使いやすいデフォルト値

- ランクは「D」がデフォルト（中間値で使いやすい）
- ギルドは「Personal」がデフォルト（個人タスクが最も多い）
- 説明は任意項目（入力の手間を減らす）

#### テストしやすい設計

- 各 API エンドポイントは独立して動作
- フロントエンドのコンポーネントは小さく分割
- `TodoApi.http` ファイルで API を簡単にテスト可能

### 3. つまずきポイントの事前対策

#### CORS 設定

```csharp
// Program.cs に追加
builder.Services.AddCors(options =>
{
    options.AddPolicy("AllowVue",
        policy => policy
            .WithOrigins("http://localhost:5173") // Viteのデフォルトポート
            .AllowAnyMethod()
            .AllowAnyHeader());
});

app.UseCors("AllowVue");
```

#### Vue.js での API 呼び出し

```typescript
// axios または fetch を使用
// 環境変数でAPIのベースURLを管理
const API_BASE_URL = "http://localhost:5000/api";
```

#### シンプルな状態管理

- 初期は Composition API の`ref`と`reactive`のみ
- Pinia/Vuex は後から必要になったら追加

### 4. モチベーション維持のコツ

- **小さな成功体験を積む**: Phase 1 で動くものを早く作る
- **見た目から入る**: CSS で少しファンタジー風にするだけで楽しい
- **達成感を可視化**: タスク完了時のアニメーションや効果音
- **拡張性を持たせる**: 将来的にレベルアップ機能やアバター機能も追加可能

---

## 実装チェックリスト（ゴール 1 達成のために）

### バックエンド（必須項目）

- [ ] Quest モデルの作成（最低限: Id, Title, IsCompleted, CreatedAt）
- [ ] QuestController の実装
  - [ ] GET /api/quests（一覧取得）
  - [ ] POST /api/quests（新規登録）
  - [ ] PATCH /api/quests/{id}/toggle（完了切り替え）
  - [ ] DELETE /api/quests/{id}（削除）
- [ ] CORS 設定（フロントエンドからアクセスできるように）
- [ ] メモリ内リストでのデータ管理（Phase 1 では DB 不要）

### フロントエンド（必須項目）

- [ ] Axios のインストールと設定
- [ ] QuestBoard コンポーネントの作成
  - [ ] クエスト一覧の表示
  - [ ] フィルター機能（全て/未完了/完了済み）
- [ ] QuestForm コンポーネントの作成
  - [ ] タイトル入力欄
  - [ ] 登録ボタン
- [ ] QuestCard コンポーネントの作成
  - [ ] クエスト情報の表示
  - [ ] 完了/未完了トグルボタン
  - [ ] 削除ボタン
  - [ ] 完了済みは打ち消し線表示
- [ ] API 呼び出しロジックの実装

### テスト（ゴール 1 の動作確認）

- [ ] API エンドポイントのテスト（TodoApi.http）
  - [ ] クエスト登録ができる
  - [ ] クエスト一覧が取得できる
  - [ ] クエスト完了/未完了が切り替えられる
  - [ ] クエスト削除ができる
- [ ] フロントエンドでの動作確認
  - [ ] タスク名を入力して新規登録できる
  - [ ] タスクを完了状態に変更できる
  - [ ] タスクを削除できる
  - [ ] 登録済みタスクが一覧表示される
  - [ ] フィルターで未完了/完了済みを切り替えられる

---

## ゴール 1 達成の最短ルート

1. **バックエンドのシンプル実装**（30 分）

   - Quest クラス作成（Id, Title, IsCompleted のみ）
   - メモリ内の List で管理
   - 4 つのエンドポイント実装

2. **フロントエンドの基本 UI**（1 時間）

   - 入力フォーム（タイトルのみ）
   - クエスト一覧表示
   - 完了ボタンと削除ボタン

3. **API 接続とフィルター**（30 分）

   - axios で API 呼び出し
   - フィルター機能の実装

4. **動作確認とデバッグ**（30 分）
   - 一連の流れをテスト
   - CORS などのエラー対応

**合計: 2.5 時間でゴール 1 達成！**
